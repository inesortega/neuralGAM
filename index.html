<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interpretable Neural Network Based on Generalized Additive Models • neuralGAM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Interpretable Neural Network Based on Generalized Additive Models">
<meta property="og:description" content="Neural Additive Model framework based on Generalized Additive Models from Hastie &amp; Tibshirani (1990, ISBN:9780412343902), which trains a different neural network to estimate the contribution of each feature to the response variable. The networks are trained independently leveraging the local scoring and backfitting algorithms to ensure that the Generalized Additive Model converges and it is additive. The resultant Neural Network is a highly accurate and interpretable deep learning model, which can be used for high-risk AI practices where decision-making should be based on accountable and interpretable algorithms.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">neuralGAM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/inesortega/neuralGAM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">


<div class="section level1">
<div class="page-header"><h1 id="neuralgam-interpretable-neural-network-based-on-generalized-additive-models">neuralGAM: Interpretable Neural Network Based on Generalized Additive Models<a class="anchor" aria-label="anchor" href="#neuralgam-interpretable-neural-network-based-on-generalized-additive-models"></a>
</h1></div>
<p>neuralGAM is a fully explainable Deep Learning framework based on Generalized Additive Models, which trains a different neural network to estimate the contribution of each feature to the response variable.</p>
<p>The networks are trained independently leveraging the local scoring and backfitting algorithms to ensure that the Generalized Additive Model converges and it is additive. The resultant Neural Network is a highly accurate and interpretable deep learning model, which can be used for high-risk AI practices where decision-making should be based on accountable and interpretable algorithms.</p>
<p>The full methodology of the method to train Generalized Additive Models using Deep Neural Networks is published in the following paper:</p>
<blockquote>
<p>Ortega-Fernandez, I., Sestelo, M. &amp; Villanueva, N.M. <em>Explainable generalized additive neural networks with independent neural network training</em>. Statistics &amp; Computing 34, 6 (2024). <a href="https://doi.org/10.1007/s11222-023-10320-5" class="external-link uri">https://doi.org/10.1007/s11222-023-10320-5</a></p>
</blockquote>
<p>and is also available in Python at the following <a href="https://github.com/inesortega/pyNeuralGAM/" class="external-link">Github repository</a>.</p>
<div class="section level2">
<h2 id="requirements">Requirements<a class="anchor" aria-label="anchor" href="#requirements"></a>
</h2>
<p>neuralGAM is based on Deep Neural Networks, and depends on Tensorflow and Keras packages. Therefore, a working Python&gt;3.10 installation with those packages installed is required.</p>
<p>We provide a helper function to get a working python installation from RStudio, which creates a miniconda environment with all the required packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://inesortega.github.io/neuralGAM/" class="external-link">neuralGAM</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/install_neuralGAM.html">install_neuralGAM</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<div class="section level3">
<h3 id="fit-a-neuralgam-with-deep-smooth-terms">Fit a neuralGAM with deep smooth terms<a class="anchor" aria-label="anchor" href="#fit-a-neuralgam-with-deep-smooth-terms"></a>
</h3>
<p>In the following example, we use synthetic data to showcase the performance of neuralGAM by fitting a model with a single layer with 1024 units.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5000</span></span>
<span><span class="va">seed</span> <span class="op">&lt;-</span> <span class="fl">42</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="va">x1</span><span class="op">**</span><span class="fl">2</span></span>
<span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">x2</span></span>
<span><span class="va">f3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">x3</span><span class="op">)</span></span>
<span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="va">f1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">f1</span><span class="op">)</span></span>
<span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="va">f2</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">f2</span><span class="op">)</span></span>
<span><span class="va">f3</span> <span class="op">&lt;-</span> <span class="va">f3</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">f3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">eta0</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">+</span> <span class="va">f1</span> <span class="op">+</span> <span class="va">f2</span> <span class="op">+</span> <span class="va">f3</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">eta0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">x3</span>, <span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ngam</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/NeuralGAM.html">neuralGAM</a></span><span class="op">(</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x3</span><span class="op">)</span>, </span>
<span>  data <span class="op">=</span> <span class="va">train</span>,</span>
<span>  num_units <span class="op">=</span> <span class="fl">128</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  activation <span class="op">=</span> <span class="st">"relu"</span>,</span>
<span>  learning_rate <span class="op">=</span> <span class="fl">0.001</span>, bf_threshold <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  max_iter_backfitting <span class="op">=</span> <span class="fl">10</span>, max_iter_ls <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  uncertainty_method <span class="op">=</span> <span class="st">"epistemic"</span>, forward_passes <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  seed <span class="op">=</span> <span class="va">seed</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ngam</span><span class="op">)</span></span></code></pre></div>
<p>You can then use the <code>plot</code> function to visualize the learnt partial effects:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ngam</span><span class="op">)</span></span></code></pre></div>
<p>Or the custom <code>autoplot</code> function for more advanced graphics using the ggplot2 library, including Confidence Intervals (if available)</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">ngam</span>, which<span class="op">=</span><span class="st">"terms"</span>, term <span class="op">=</span> <span class="st">"x1"</span>, interval <span class="op">=</span> <span class="st">"confidence"</span><span class="op">)</span></span></code></pre></div>
<p>To obtain predictions from new data, use the <code>predict</code> function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5000</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">x3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Obtain linear predictor</span></span>
<span><span class="va">eta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">ngam</span>, newdata <span class="op">=</span> <span class="va">test</span>, type <span class="op">=</span> <span class="st">"link"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Obtain predicted response using se.fit = TRUE to obtain standard errors:</span></span>
<span><span class="va">yhat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">ngam</span>, newdata <span class="op">=</span> <span class="va">test</span>, type <span class="op">=</span> <span class="st">"response"</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">yhat</span><span class="op">$</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">yhat</span><span class="op">$</span><span class="va">se.fit</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Obtain each component of the linear predictor </span></span>
<span><span class="va">terms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">ngam</span>, newdata <span class="op">=</span> <span class="va">test</span>, type <span class="op">=</span> <span class="st">"terms"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Obtain only certain terms: </span></span>
<span><span class="va">terms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">ngam</span>, newdata <span class="op">=</span> <span class="va">test</span>, type <span class="op">=</span> <span class="st">"terms"</span>, terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="per-term-configuration">Per-term configuration<a class="anchor" aria-label="anchor" href="#per-term-configuration"></a>
</h3>
<p><code>neuralGAM</code> from version 2.0 allows to specify hyperparameters per smooth term inside s(), overriding global defaults, and the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> now print each smooth term configuraion:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ngam</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/NeuralGAM.html">neuralGAM</a></span><span class="op">(</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">x1</span>, num_units <span class="op">=</span> <span class="fl">32</span><span class="op">)</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x3</span>, activation <span class="op">=</span> <span class="st">"tanh"</span><span class="op">)</span>, </span>
<span>  data <span class="op">=</span> <span class="va">train</span>,</span>
<span>  num_units <span class="op">=</span> <span class="fl">64</span>,  <span class="co"># default for terms without explicit num_units</span></span>
<span>  seed <span class="op">=</span> <span class="va">seed</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Per-term configuration supports custom initializers and regularizers for both weights and biases, enabling fine control over model complexity and stability. For example, you can set one of the neural networks to use L2 regularization and He initialization using Keras functions directly (i.e. <code><a href="https://rdrr.io/pkg/keras/man/regularizer_l1.html" class="external-link">keras::regularizer_l1()</a></code>).</p>
<p>This is useful for:</p>
<ul>
<li>Preventing overfitting (L1/L2 regularization)</li>
<li>Stabilizing training for deep smooth terms (He/Glorot initializers)</li>
<li>Applying different constraints to specific smooth terms (for example, more complex functions might require more complex / deeper architectures)</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ngam</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/NeuralGAM.html">neuralGAM</a></span><span class="op">(</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span></span>
<span>         <span class="va">x1</span>, </span>
<span>         kernel_initializer <span class="op">=</span> <span class="fu">keras</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/keras/man/initializer_he_normal.html" class="external-link">initializer_he_normal</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>         bias_initializer   <span class="op">=</span> <span class="fu">keras</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/keras/man/initializer_zeros.html" class="external-link">initializer_zeros</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>         kernel_regularizer <span class="op">=</span> <span class="fu">keras</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/keras/man/regularizer_l1.html" class="external-link">regularizer_l2</a></span><span class="op">(</span><span class="fl">0.01</span><span class="op">)</span>,</span>
<span>         bias_regularizer   <span class="op">=</span> <span class="fu">keras</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/keras/man/regularizer_l1.html" class="external-link">regularizer_l1</a></span><span class="op">(</span><span class="fl">0.001</span><span class="op">)</span></span>
<span>       <span class="op">)</span> <span class="op">+</span></span>
<span>       <span class="fu">s</span><span class="op">(</span><span class="va">x2</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">train</span>,</span>
<span>  num_units <span class="op">=</span> <span class="fl">64</span>,</span>
<span>  activation <span class="op">=</span> <span class="st">"relu"</span>,</span>
<span>  seed <span class="op">=</span> <span class="va">seed</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> now prints each smooth terms configuration and the essential parameters of each network’s architecture.</p>
</div>
<div class="section level3">
<h3 id="confidence-intervals">Confidence Intervals<a class="anchor" aria-label="anchor" href="#confidence-intervals"></a>
</h3>
<p>Enable confidence intervals by setting <code>uncertainty_method</code> and specifying a sensitivity level via <code>alpha</code> (i.e. <code>0.05</code> for 95% coverage). For epistemic variance, <code>forward_passes &gt; 150</code> is recommended.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ngam</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/NeuralGAM.html">neuralGAM</a></span><span class="op">(</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x2</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">train</span>,</span>
<span>  uncertainty_method <span class="op">=</span> <span class="st">"epistemic"</span>,</span>
<span>  forward_passes <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  num_units <span class="op">=</span> <span class="fl">1024</span>,</span>
<span>  seed <span class="op">=</span> <span class="va">seed</span></span>
<span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">ngam</span>, newdata <span class="op">=</span> <span class="va">test</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="cross-validation-and-training-history">Cross-validation and Training History<a class="anchor" aria-label="anchor" href="#cross-validation-and-training-history"></a>
</h3>
<p>You can monitor the validation loss during training using the <code>validation_split</code> parameter. You can then visualize the how the loss evolves per backfitting iteration using the <code><a href="reference/plot_history.html">plot_history()</a></code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ngam</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/NeuralGAM.html">neuralGAM</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x3</span><span class="op">)</span>,</span>
<span>                  data <span class="op">=</span> <span class="va">train</span>,</span>
<span>                  num_units <span class="op">=</span> <span class="fl">1024</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>                  activation <span class="op">=</span> <span class="st">"relu"</span>,</span>
<span>                  learning_rate <span class="op">=</span> <span class="fl">0.001</span>, bf_threshold <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>                  max_iter_backfitting <span class="op">=</span> <span class="fl">10</span>, max_iter_ls <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                  validation_split <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>                  seed <span class="op">=</span> <span class="va">seed</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot loss per backfitting iteration</span></span>
<span><span class="fu"><a href="reference/plot_history.html">plot_history</a></span><span class="op">(</span><span class="va">ngam</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plot_history.html">plot_history</a></span><span class="op">(</span><span class="va">ngam</span>, select <span class="op">=</span> <span class="st">"x1"</span><span class="op">)</span>       <span class="co"># Plot just x1</span></span>
<span><span class="fu"><a href="reference/plot_history.html">plot_history</a></span><span class="op">(</span><span class="va">ngam</span>, metric <span class="op">=</span> <span class="st">"val_loss"</span><span class="op">)</span> <span class="co"># Plot only validation loss</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="detailed-model-inspection">Detailed model inspection<a class="anchor" aria-label="anchor" href="#detailed-model-inspection"></a>
</h3>
<p>The enhanced summary() shows:</p>
<ul>
<li>Family, formula, sample size, intercept, deviance explained, MSE</li>
<li>Per-term hyperparameters (units, activation, learning rate, initializers, regularizers)</li>
<li>Layer configuration for each Keras model</li>
<li>Linear coefficients (if a parametric part exists)</li>
<li>Compact training history</li>
</ul>
<p>Moreover, after fitting a <code>neuralGAM</code> model, it is important to evaluate whether the model assumptions are reasonable and whether predictions are well calibrated.</p>
<p>The helper function <code><a href="reference/diagnose.html">diagnose()</a></code> provides a <strong>2×2 diagnostic panel</strong> similar to <code>gratia::appraise()</code> for <code>mgcv</code> models.</p>
<p>The four panels are:</p>
<ol style="list-style-type: decimal">
<li><p><strong>QQ plot of residuals</strong> (top-left)<br>
Compares sample residuals to theoretical quantiles. A straight line indicates a good fit.<br>
Deviations suggest skewness, heavy tails, or outliers.</p></li>
<li><p><strong>Residuals vs linear predictor η</strong> (top-right)<br>
Shows residuals against the fitted linear predictor, with a LOESS smoother.<br>
A flat trend near 0 is ideal. Systematic curvature means the model missed a trend; funnel shapes suggest heteroscedasticity.</p></li>
<li><p><strong>Histogram of residuals</strong> (bottom-left)<br>
Displays the distribution of residuals. Ideally symmetric and centered at 0.<br>
Skewness or multimodality may indicate model misspecification.</p></li>
<li><p><strong>Observed vs fitted</strong> (bottom-right)<br>
Compares predicted values with observed outcomes. For continuous data, points should align with the 45° line.<br>
For binary outcomes, this acts as a calibration plot: predicted probabilities should match observed frequencies.</p></li>
</ol>
<p><strong>Notes</strong></p>
<ol style="list-style-type: decimal">
<li><p><code>residual_type</code> can be <code>deviance</code> (default), <code>pearson</code>, or <code>quantile</code>. Quantile residuals (Dunn–Smyth) are recommended for discrete families (binomial, Poisson) because they are continuous and approximately normal.</p></li>
<li>
<p><code>qq_method</code> controls reference quantiles:</p>
<ul>
<li>
<code>uniform</code>: fast and default.</li>
<li>
<code>simulate</code>: most faithful and provides bands, but slower</li>
<li>
<code>normal</code>: fallback</li>
</ul>
</li>
</ol>
<p>Together, these diagnosis plots help assess whether residuals behave like noise, whether systematic trends remain and if predictions are unbiased and calibrated.</p>
</div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use neuralGAM in your research, please cite the following paper:</p>
<blockquote>
<p>Ortega-Fernandez, I., Sestelo, M. &amp; Villanueva, N.M. <em>Explainable generalized additive neural networks with independent neural network training</em>. Statistics &amp; Computing 34, 6 (2024). <a href="https://doi.org/10.1007/s11222-023-10320-5" class="external-link uri">https://doi.org/10.1007/s11222-023-10320-5</a></p>
</blockquote>
<div class="sourceCode" id="cb10"><pre class="sourceCode bibtex"><code class="sourceCode bibtex"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="va">@article</span>{<span class="ot">ortega2024explainable</span>,</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="dt">author</span> = {Ortega-Fernandez, Ines and Sestelo, Marta and Villanueva, Nora M},</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="dt">doi</span> = {10.1007/s11222-023-10320-5},</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="dt">issn</span> = {1573-1375},</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="dt">journal</span> = {Statistics and Computing},</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="dt">number</span> = {1},</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="dt">pages</span> = {6},</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="dt">title</span> = {{Explainable generalized additive neural networks with independent neural network training}},</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="dt">url</span> = {https://doi.org/10.1007/s11222-023-10320-5},</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="dt">volume</span> = {34},</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="dt">year</span> = {2023}</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=neuralGAM" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/inesortega/neuralGAM/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/inesortega/neuralGAM/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.mozilla.org/en-US/MPL/2.0/" class="external-link">MPL-2.0</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing neuralGAM</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Ines Ortega-Fernandez <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0002-8041-6860" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Marta Sestelo <br><small class="roles"> Author, copyright holder </small> <a href="https://orcid.org/0000-0003-4284-6509" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/inesortega/NeuralGAM/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/inesortega/NeuralGAM/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://github.com/inesortega/NeuralGAM/actions/workflows/test-coverage.yaml" class="external-link"><img src="https://github.com/inesortega/NeuralGAM/actions/workflows/test-coverage.yaml/badge.svg" alt="test-coverage"></a></li>
<li><a href="https://app.codecov.io/gh/inesortega/neuralGAM?branch=main" class="external-link"><img src="https://codecov.io/gh/inesortega/neuralGAM/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://cranlogs.r-pkg.org/downloads/total/2023-09-01:2024-09-25/neuralGAM" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/neuralGAM" alt="CRAN Downloads"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Ines Ortega-Fernandez, Marta Sestelo.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
