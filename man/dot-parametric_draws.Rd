% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/predict.NeuralGAM.R
\name{.parametric_draws}
\alias{.parametric_draws}
\title{Parametric draws and per-term parametric contributions}
\usage{
.parametric_draws(ngam, x, forward_passes = 300L)
}
\arguments{
\item{ngam}{A fitted \code{neuralGAM} object with a linear submodel at \code{$model$linear}.}

\item{x}{A \code{data.frame}/\code{matrix} with the parametric covariates required by
the linear submodel. The number of rows defines \eqn{n}.}

\item{forward_passes}{Integer \eqn{B \ge 2}; number of coefficient draws (default \code{300L}).}
}
\value{
A list with components:
\itemize{
\item \code{beta_draws}: \eqn{B \times p_\beta} matrix of coefficient draws (or \code{NULL});
\item \code{eta_param_draws}: \eqn{B \times n} matrix of parametric predictor draws (or \code{NULL});
\item \code{term_draws}: named list of \eqn{B \times n} matrices with term-wise contributions.
}
}
\description{
Generate Gaussian draws of the linear coefficients \eqn{\beta} from the fitted
parametric submodel and compute:
\itemize{
\item \strong{\code{beta_draws}}: a \eqn{B \times p_\beta} matrix of coefficient draws,
\item \strong{\code{eta_param_draws}}: a \eqn{B \times n} matrix of the parametric
part of the linear predictor \eqn{X\beta^{(b)}}, and
\item \strong{\code{term_draws}}: a named list of \eqn{B \times n} matrices, one per
parametric term, giving its per-observation contribution across draws.
}
Returns empty placeholders if no parametric terms are present or the linear submodel is \code{NULL}.
}
\details{
The function reconstructs the linear submodelâ€™s design matrix using
\code{stats::model.frame} and \code{stats::model.matrix} to ensure exact alignment with
the fitted formula (including factors, contrasts, and interactions). For each named
parametric term in \code{ngam$formula$p_terms}, the per-term contribution is computed
by selecting the subset of design columns associated with that term and multiplying
by the corresponding subset of coefficient draws. If a term cannot be matched to
specific design columns (e.g., aliased), it is skipped.
}
\seealso{
\code{\link{.joint_draws_eta}}
}
\keyword{internal}
